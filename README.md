# Signature-
#include "WinHttp.au3" #include &lt;Crypt.au3> #include &lt;encodebase64.au3> #include &lt;Date.au3> $sTwitter_oAuth_Consumer_key = '' $sTwitter_ConsumerSecret = '' $sTwitter_oAuth_Token = '' $sTwitter_TokenSecret = '' $header = gen_sig_base() $header = StringSplit($header, '|', 2) Local $arr = _WinHttpGetIEProxyConfigForCurrentUser() If $arr[2] &lt;> '' Then $hOpen = _WinHttpOpen('Mozilla/5.0', $WINHTTP_ACCESS_TYPE_NAMED_PROXY, $arr[2]) Else $hOpen = _WinHttpOpen('Mozilla/5.0') EndIf $hConnect = _WinHttpConnect($hOpen, "api.twitter.com", $INTERNET_DEFAULT_HTTPS_PORT) $header[2] = URLEncode(_Base64Encode(BinaryToString($header[2]))) ConsoleWrite('epoch  ' &amp; $header[0] &amp; @CRLF) ConsoleWrite('nonce  ' &amp; $header[1] &amp; @CRLF) ConsoleWrite('signature ' &amp; $header[2] &amp; @CRLF) $hRequestSSL = _WinHttpSimpleSendSSLRequest($hConnect, 'GET', "1.1/direct_messages.json?count=10", Default, Default, 'Authorization: OAuth ' _ &amp; 'oauth_consumer_key="' &amp; $sTwitter_oAuth_Consumer_key &amp; '", ' &amp; 'oauth_nonce="' &amp; $header[1] &amp; '", ' _ &amp; 'oauth_signature="' &amp; $header[2] &amp; '", ' &amp; 'oauth_signature_method="HMAC-SHA1", ' _ &amp; 'oauth_timestamp="' &amp; $header[0] &amp; '", ' &amp; 'oauth_token="' &amp; $sTwitter_oAuth_Token &amp; '", ' _ &amp; 'oauth_version="1.0"') $sReturned = _WinHttpSimpleReadData($hRequestSSL) ConsoleWrite($sReturned &amp; @CRLF) _WinHttpCloseHandle($hRequestSSL) _WinHttpCloseHandle($hConnect) _WinHttpCloseHandle($hOpen) Func gen_sig_base() Local $epoch, $nonce, $SignatureBase, $since_id, $Signature $tCur = _Date_Time_GetSystemTime() $date = _Date_Time_SystemTimeToDateTimeStr($tCur, 1) $epoch = _Epoch_encrypt($date) _Crypt_Startup() $nonce = StringTrimLeft(_Crypt_HashData($epoch &amp; $sTwitter_oAuth_Consumer_key, $CALG_MD5),2) _Crypt_Shutdown() $since_id = IniRead('Twitter.ini', 'TwitterAPI', 'since_id_dm', '') $SignatureBase = 'GET&amp;https%3A%2F%2Fapi.twitter.com%2F1.1%2Fdirect_messages.json&amp;count%3D10%26oauth_consumer_key%3D' &amp; $sTwitter_oAuth_Consumer_key &amp; '%26oauth_nonce%3D' &amp; $nonce &amp; '%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D' &amp; $epoch &amp; '%26oauth_token%3D' &amp; $sTwitter_oAuth_Token &amp; '%26oauth_version%3D1.0' $Signature = hmac($sTwitter_ConsumerSecret &amp; '&amp;' &amp; $sTwitter_TokenSecret, $SignatureBase, 'sha1')
